; This file is generated from a template using ansible.
;
; {{ ansible_managed }}
;
; Zone file for {{ item.key | regex_replace('_', '.') }}

{% if item.value.ttl is defined %}
$TTL {{ item.value.ttl }}
{% else %}
$TTL {{ named_conf_zone_ttl }}
{% endif %}

{% if item.value.expire is defined and item.value.soa is defined %}
@      {{ item.value.expire }}    IN      SOA     {{ item.value.soa }} (
{% else %}
@      {{ named_conf_zone_expire}}    IN      SOA     {{ named_conf_zone_soa }} (
{% endif %}
                {{ ansible_date_time.date | regex_replace('-', '') }}{{ ansible_date_time.time | regex_replace('^([0-9]{2}).*$', '\\1') }}	; serial, todays date+todays
{% if item.value.refresh is defined %}
                {{ item.value.refresh }}		; refresh, seconds
{% else %}
                {{ named_conf_zone_refresh }}   ; refresh, seconds
{% endif %}
{% if item.value.retry is defined %}
                {{ item.value.retry }}		; retry, seconds
{% else %}
                {{ named_conf_zone_retry }}     ; retry, seconds
{% endif %}
{% if item.value.expire is defined %}
                {{ item.value.expire }}		; expire, seconds
{% else %}
                {{ named_conf_zone_expire }}       ; expire, seconds
{% endif %}
{% if item.value.expire_min is defined %}
                {{ item.value.expire_min }} )		; minimum, seconds
{% else %}
                {{ named_conf_zone_expire_min }} )     ; minimum, seconds
{% endif %}
{% for nameserver in item.value.nameserver_in %}
{% if item.value.expire is defined %}
{{ item.key | regex_replace('_', '.') }}. {{ item.value.expire }} IN NS {{ nameserver }}.
{% else %}
{{ item.key | regex_replace('_', '.') }}. IN NS {{ nameserver }}.
{% endif %}
{% endfor %}

{% for record in item.value.records %}
{{ record }}
{% endfor %}
